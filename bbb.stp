{"metadata":{"guid":"721f0dcd-f5d3-41ff-976c-e24de894d347","url":"/v2/streaming_pipelines/721f0dcd-f5d3-41ff-976c-e24de894d347","created_at":"2019-02-07T16:45:23Z","updated_at":"2019-02-19T12:13:59Z","revision":1550578439667},"entity":{"name":"bbb","description":"","project_guid":"f5dd27bb-3d3f-4b85-869e-b1a7f48e4d22","graph":{"doc_type":"pipeline","version":"1.0","json_schema":"http://www.ibm.com/ibm/wdp/flow-v1.0/pipeline-flow-v1-schema.json","id":"","app_data":{"ui_data":{"name":"bbb"}},"primary_pipeline":"primary-pipeline","pipelines":[{"id":"primary-pipeline","runtime":"streams","nodes":[{"id":"messagehubsample_t5huqueagqe","type":"binding","op":"ibm.streams.sources.messagehubsample","outputs":[{"id":"target","schema_ref":"schema0","links":[{"node_id_ref":"code_ml_76j0bv8c7lu","port_id_ref":"source"}]}],"parameters":{"topic":"geofenceSampleData","schema_mapping":[{"name":"customerId","type":"double","path":"/customerId"},{"name":"latitude","type":"double","path":"/latitude"},{"name":"longitude","type":"double","path":"/longitude"},{"name":"time_stamp","type":"timestamp","path":"/time_stamp"}]},"app_data":{"ui_data":{"label":"Sample Data","x_pos":-30,"y_pos":220}}},{"id":"code_ml_76j0bv8c7lu","type":"execution_node","op":"ibm.streams.operations.code-ml","outputs":[{"id":"target","schema_ref":"schema1","links":[{"node_id_ref":"debug_xswwks0prwc","port_id_ref":"source"}]}],"parameters":{"model_source":"Cloud Object Storage","file_objects":[{"file_reference_name":"file1","auto_refresh":false,"connection":{"ref":"2ad45126-a6c3-477b-b3f8-bb2845fafb13","project_ref":"f5dd27bb-3d3f-4b85-869e-b1a7f48e4d22","properties":{"asset":{"path":"/eliezerbucket/forcos.txt","asset_types":[],"assets":[],"fields":[{"name":"uploaded to cos","type":{"type":"varchar","length":1024,"scale":0,"nullable":true,"signed":false}}],"extended_metadata":[],"first":{"href":"https://api.dataplatform.test.cloud.ibm.com/v2/connections/2ad45126-a6c3-477b-b3f8-bb2845fafb13/assets?project_id=f5dd27bb-3d3f-4b85-869e-b1a7f48e4d22&offset=0&limit=100&path=%2Feliezerbucket%2Fforcos.txt"},"total_count":1,"logs":[]}}}}],"code":"#\n# YOU MUST EDIT THE SCHEMA and add all attributes that you are returning as output.\n#\n# Preinstalled Python packages can be viewed from the Settings pane.\n# In the Settings pane you can also install additional Python packages.\n\nimport sys\nimport logging\nimport pickle\n\n# Use this logger for tracing or debugging your code:\nlogger = logging.getLogger(__name__)\n# Example:\n#     logger.debug('Got to step 2...')\n\n# init() function will be called once on pipeline initialization\n# @state a Python dictionary object for keeping state. The state object is passed to the process function\ndef init(state):\n    # do something once on pipeline initialization and save in the state object\n    pass\n\n\n# process() function will be invoked on every event tuple\n# @event a Python dictionary object representing the input event tuple as defined by the input schema\n# @state a Python dictionary object for keeping state over subsequent function calls\n# return must be a Python dictionary object. It will be the output of this operator.\n#        Returning None results in not submitting an output tuple for this invocation.\n# You must declare all output attributes in the Edit Schema window.\ndef process(event, state):\n    event['readFile'] = state['readFile']\n    return event\n\n# Make sure the Python packages' version that is used in this streams flow is compatible\n# with the one used to create the Pickled object (Click Settings > Runtime).\n#\n# If you are using a different serialization method, you must modify the code below:\ndef load_file1(state, path_file1):\n    with open(path_file1) as myfile:\n        state['readFile'] = myfile.read().strip()\n        \n\t","schema_mapping":[{"name":"customerId","type":"double"},{"name":"latitude","type":"double"},{"name":"longitude","type":"double"},{"name":"time_stamp","type":"timestamp"},{"name":"readFile","type":"string","length":0,"source_elem_name":"","target_elem_name":""}]},"app_data":{"ui_data":{"label":"Python Model","x_pos":350,"y_pos":230}}},{"id":"debug_xswwks0prwc","type":"binding","op":"ibm.streams.targets.debug","parameters":{},"app_data":{"ui_data":{"label":"Debug","x_pos":600,"y_pos":230}}}]}],"schemas":[{"id":"schema0","fields":[{"name":"customerId","type":"double"},{"name":"latitude","type":"double"},{"name":"longitude","type":"double"},{"name":"time_stamp","type":"timestamp"}]},{"id":"schema1","fields":[{"name":"customerId","type":"double"},{"name":"latitude","type":"double"},{"name":"longitude","type":"double"},{"name":"time_stamp","type":"timestamp"},{"name":"readFile","type":"string"}]}]},"engines":{"streams":{"instance_id":"f2cfe308-de93-46d9-a3b5-f2c6d354278c"}}}}